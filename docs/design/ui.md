# バッチ処理可視化ダッシュボード 画面設計

## 1. 主要画面一覧

1. **ダッシュボード（トップ画面）**
   - バッチ処理の一覧表示
   - 各バッチの状態（成功/失敗/実行中など）を一目で把握
   - サマリー（成功数・失敗数・実行中数など）

2. **バッチ詳細画面**
   - 選択したバッチの詳細情報（パラメータ、ログ、エラー内容など）
   - 実行履歴のリスト
   - 手動実行・再実行ボタン（権限に応じて）

3. **検索・フィルタUI**
   - バッチ名、状態、日付などで絞り込み
   - 検索結果の一覧表示

4. **通知・アラート表示**
   - 失敗時や異常時のアラート
   - 画面上部やモーダルで表示

5. **（オプション）ユーザー管理画面**
   - ユーザーの一覧・権限管理

---

## 2. 画面遷移イメージ

```
[ダッシュボード]
   └─> [バッチ詳細画面]
         └─> [実行履歴詳細]
[ダッシュボード] ←→ [検索・フィルタ]
[ダッシュボード] ←→ [通知・アラート]
```

---

## 3. 各画面の主なUI要素

### ダッシュボード
- バッチ一覧テーブル（バッチ名／状態／開始時刻／終了時刻／所要時間／操作ボタン）
- サマリーカード（成功数・失敗数・実行中数）
- 検索・フィルタバー
- 通知アイコン

### バッチ詳細画面
- バッチ基本情報（ID、名前、状態、パラメータ）
- 実行履歴リスト
- ログ表示エリア
- エラー内容（失敗時のみ）
- 手動実行・再実行ボタン

### 検索・フィルタUI
- テキストボックス（バッチ名検索）
- セレクトボックス（状態選択）
- 日付ピッカー（期間指定）

### 通知・アラート
- トースト通知
- アラートダイアログ

### ユーザー管理画面

```
+-------------------------------------------------------------+
| ユーザー管理                                               |
+-------------------------------------------------------------+
| [新規ユーザー追加]                                         |
+-------------------------------------------------------------+
| ユーザー名   | 権限       | 操作                           |
|-------------------------------------------------------------|
| userA      | admin      | 編集  削除                      |
| userB      | operator   | 編集  削除                      |
| userC      | developer  | 編集  削除                      |
| ...                                               ...       |
+-------------------------------------------------------------+
| [戻る]                                                     |
+-------------------------------------------------------------+
```

---

## 4. ワイヤーフレーム

### ダッシュボード（トップ画面）

```
+-------------------------------------------------------------+
| バッチ処理可視化ダッシュボード                              |
+-------------------+-------------------+---------------------+
| 成功: 10          | 失敗: 2           | 実行中: 1           |
+-------------------+-------------------+---------------------+
| [検索バー]  [状態: ▼]  [日付: □~□]  [検索]                |
+-------------------------------------------------------------+
| バッチ名   | 状態   | 開始時刻        | 終了時刻   | 操作   |
|-------------------------------------------------------------|
| batchA    | 成功   | 2024-06-01 10:00 | 10:05      | 詳細   |
| batchB    | 失敗   | 2024-06-01 11:00 | 11:02      | 詳細   |
| ...                                                     ... |
+-------------------------------------------------------------+
| [通知アイコン]                                            |
+-------------------------------------------------------------+
```

### バッチ詳細画面のワイヤーフレーム

```
+-------------------------------------------------------------+
| バッチ詳細                                                 [×] |
+-------------------------------------------------------------+
| バッチ名: batchA                                            |
| 状態: 成功   開始: 2024-06-01 10:00   終了: 10:05           |
| パラメータ: { ... }                                         |
+-------------------------------------------------------------+
| [手動実行] [再実行]                                         |
+-------------------------------------------------------------+
| 実行履歴                                                    |
|-------------------------------------------------------------|
| # | 開始時刻           | 終了時刻   | 状態   | 操作         |
|---|--------------------|------------|--------|--------------|
| 1 | 2024-06-01 10:00   | 10:05      | 成功   | ログ表示     |
| 2 | 2024-05-31 10:00   | 10:04      | 失敗   | ログ表示     |
|...|                    |            |        |              |
+-------------------------------------------------------------+
| ログ表示エリア（選択した履歴のログやエラー内容を表示）       |
+-------------------------------------------------------------+
```

### 検索・フィルタUI

```
+-------------------------------------------------------------+
| 検索・フィルタ                                             |
+-------------------------------------------------------------+
| バッチ名: [__________]   状態: [▼すべて]   日付: [□~□]   |
| [検索] [リセット]                                         |
+-------------------------------------------------------------+
| 検索結果一覧                                               |
|-------------------------------------------------------------|
| バッチ名   | 状態   | 開始時刻        | 終了時刻   | 操作   |
|-------------------------------------------------------------|
| batchA    | 成功   | 2024-06-01 10:00 | 10:05      | 詳細   |
| batchB    | 失敗   | 2024-06-01 11:00 | 11:02      | 詳細   |
| ...                                                     ... |
+-------------------------------------------------------------+
```

### 通知・アラート表示

```
+-------------------------------------------------------------+
| [!] バッチ「batchB」が失敗しました                          |
+-------------------------------------------------------------+
| 詳細: エラー内容のメッセージ                               |
+-------------------------------------------------------------+
| [閉じる] [詳細を見る]                                      |
+-------------------------------------------------------------+
```

// トースト通知例
```
+-------------------------------+
| [!] batchBが失敗しました      |
+-------------------------------+
```

今後、他の画面のワイヤーフレームもこのセクションに追加してください。 

---

## 5. 詳細な画面設計

### 5.1 ダッシュボード画面の状態遷移
- 初期表示：バッチ一覧・サマリーを表示
- 検索・フィルタ実行：検索条件に応じて一覧を再描画
- バッチ詳細ボタン押下：バッチ詳細画面へ遷移
- 通知アイコン押下：通知一覧モーダル表示

### 5.2 バッチ詳細画面の状態遷移
- 初期表示：バッチ基本情報・実行履歴を表示
- 実行履歴クリック：ログ表示エリアに詳細表示 or ログモーダル表示
- 手動実行ボタン押下：手動実行フォーム表示
- 再実行ボタン押下：パラメータ確認後、APIリクエスト

### 5.3 モーダル・ダイアログ詳細

#### バッチ失敗時のアラートモーダル
```
+-------------------------------+
| [!] バッチ「batchB」が失敗    |
+-------------------------------+
| エラー内容: ...               |
+-------------------------------+
| [閉じる] [詳細を見る]         |
+-------------------------------+
```
- [閉じる]：モーダルを閉じる
- [詳細を見る]：バッチ詳細画面へ遷移

#### ユーザー編集モーダル
```
+-------------------------------+
| ユーザー編集                  |
+-------------------------------+
| ユーザー名: [__________]      |
| 権限:    [▼admin]             |
+-------------------------------+
| [保存] [キャンセル]           |
+-------------------------------+
```
- [保存]：入力内容をバリデーションし、OKなら反映
- [キャンセル]：モーダルを閉じる

### 5.4 フォーム詳細

#### バッチ手動実行フォーム
```
+-------------------------------+
| バッチ手動実行                |
+-------------------------------+
| パラメータ1: [__________]     |
| パラメータ2: [__________]     |
| ...                           |
+-------------------------------+
| [実行] [キャンセル]           |
+-------------------------------+
```
- [実行]：入力値をバリデーションし、APIリクエスト
- [キャンセル]：フォームを閉じる

### 5.5 画面遷移図（テキスト例）
```
[ダッシュボード]
   ├─(詳細ボタン)─> [バッチ詳細画面]
   │                   ├─(履歴クリック)─> [ログモーダル]
   │                   └─(手動実行)─> [手動実行フォーム]
   ├─(通知アイコン)─> [通知モーダル]
   └─(ユーザー管理)─> [ユーザー管理画面]
                           └─(編集)─> [ユーザー編集モーダル]
```

### 5.6 バリデーション・エラー表示
- 入力フォーム下にエラーメッセージ表示
- モーダル内でAPIエラー時はアラート表示

---

## 6. Atomic Designに基づくUI部品設計

Atomic Designは、UIを「原子（Atom）」「分子（Molecule）」「有機体（Organism）」「テンプレート（Template）」「ページ（Page）」の5階層で設計する手法です。

### 6.1 各階層の説明と例

#### Atom（原子）
- ボタン（Button）
- テキストボックス（Input）
- セレクトボックス（Select）
- ラベル（Label）
- アイコン（Icon）
- タグ（StatusTag）

#### Molecule（分子）
- 検索バー（SearchBar：Input + Button）
- ステータス表示（StatusLabel：Icon + Text）
- 日付ピッカー（DateRangePicker：Input + Input）

#### Organism（有機体）
- バッチ一覧テーブル（BatchTable）
- サマリーカード群（SummaryCards）
- 実行履歴リスト（HistoryList）
- 通知リスト（NotificationList）
- フォーム（UserEditForm, BatchRunForm）

#### Template（テンプレート）
- ダッシュボードテンプレート（DashboardTemplate）
- バッチ詳細テンプレート（BatchDetailTemplate）
- ユーザー管理テンプレート（UserManagementTemplate）

#### Page（ページ）
- ダッシュボードページ（DashboardPage）
- バッチ詳細ページ（BatchDetailPage）
- ユーザー管理ページ（UserManagementPage）

### 6.2 具体例：バッチ一覧テーブルの分解

- **Atom**  
  - Button（詳細ボタン）  
  - StatusTag（状態表示）  
  - TableCell（セル）  
- **Molecule**  
  - TableRow（1行分のバッチ情報）  
- **Organism**  
  - BatchTable（バッチ一覧全体）

### 6.3 ディレクトリ構成例

```
/src
  /components
    /atoms
      Button.tsx
      Input.tsx
      StatusTag.tsx
      ...
    /molecules
      SearchBar.tsx
      StatusLabel.tsx
      TableRow.tsx
      ...
    /organisms
      BatchTable.tsx
      SummaryCards.tsx
      HistoryList.tsx
      ...
    /templates
      DashboardTemplate.tsx
      BatchDetailTemplate.tsx
      ...
    /pages
      DashboardPage.tsx
      BatchDetailPage.tsx
      ...
```

---

今後、各部品の詳細設計やStorybookによるカタログ化もこの方針で進めてください。
